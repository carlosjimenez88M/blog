---
title: "Distribución Beta"
date: 2019-02-13
description: "Introducción en el sentido de la abstracción de la distribución beta"
output: html_document
mathjax: "true"
---



<p><img src="/post/2019-02-09-Distribucion_Beta_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Durante muchos años, tanto en el ambito acádemico como en el mundo de la estadística aplicada la <em>distribución beta</em> ha sido tratada con especial rezago en su definición y aplicación, dicho lo anterior esta entrada intenta dar una visión sobre la filosofía de la distribución y en especial darle una aplicación empirica para ver su potencial en el mundo real.</p>
<p>Parto de una afirmación, los mayores usos de esta distribución se dan en el plano del mundo <strong>bayesiano</strong>, sobre todo para el desarrollo de ciencias experimentales y la teoría de la decisión. Lo anterior no quiere decir que no tenga espacio en otros ambitos de la estadística, más si da un uso claro en ramas primordiales.</p>
<p>Por último reafirmando en palabras de <a href="http://varianceexplained.org/">David Robinson</a>, es de vital importancia en el mundo de la ciencia de datos dado que ** empirical bayes (de donde parte el uso de la distribución beta) is especially well suited to the modern field of data science**. Sobre este autor se hablara más adelante.</p>
<div id="aproximaciones-sobre-la-distribución-beta" class="section level2">
<h2>Aproximaciones sobre la distribución beta</h2>
<p>Se parte de una antesala:</p>
<blockquote>
<p>“La distribución beta difiere de las distribuciones continuas […] dado que solo se puede usar para describir variables aleatorias que tomen valores entre 0 y 1” Gutierrez (2010)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
</blockquote>
<p>Estos limites de intervalos son pieza fundamental para entender después del uso de parámetros y los posibles resultados que se pueden obtener sobre eventos estudiados.</p>
<p>Complementando la definición de Gutiérrez en 2013 los profesores Paul Johnson y Matt Beverlin la describieron de la siguiente manera</p>
<blockquote>
<p>“La función de densidad beta es una forma muy versátil de representar resultados como proporciones o probabilidades”<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
</blockquote>
<p>Los mismos autores reafirman la antesala sobre el uso de esta distribución al decir que <strong>“The Beta can be used to describe not only the variety observed across people, but it can
also describe your subjective degree of belief (in a Bayesian sense)”</strong><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<p>Más, la definición que a mi parecer logra definir mejor lo que es la <em>beta</em>, es aquella que dio David Robinson en 2017 en su libro Introduction to Empirical Bayes, donde la describe de la siguiente manera</p>
<blockquote>
<p>“The beta distribution is good at representing a probability distribution of probabilities- that is, it represents all the possible values of a probability when we don´t know what that probability is.”<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
</blockquote>
<p>Antes de entrar en el terreno de las aplicaciones desarrollare la matemáticas que hay detrás de ella.</p>
</div>
<div id="aspectos-matemáticos" class="section level2">
<h2>Aspectos matemáticos</h2>
<div id="función-de-densidad" class="section level3">
<h3>Función de densidad</h3>
<p>Una variable aleatoria <span class="math inline">\(\mathrm{X}\)</span> tiene distribución beta si su función de densidad está dada de la siguiente manera:</p>
<p><span class="math display">\[
\mbox{ Función Beta}=B(a,b)=\frac{\Gamma(a) \Gamma(b)}{\Gamma(a+b)}=\int_{0}^{1} u^{a-1}(1-u)^{b-1 }du
\]</span></p>
<p><span class="math display">\[
f_{X}(x)=\frac{1}{B(a,b)}x^{a-1}(1-x)^{b-1}I_{(0,1)}(x) \mbox{ Dado los parámetros }a&gt;0 \mbox{ y } b&gt;0
\]</span></p>
<p>Visto lo anterior se puede decir que la <strong>Beta</strong> toma valores de <span class="math inline">\((1,1)\)</span> en los parámetros <span class="math inline">\((a,b)\)</span> pasa a ser una uniforme continua <span class="math inline">\(Unif(0,1)\)</span></p>
</div>
<div id="momentos-de-la-beta" class="section level3">
<h3>Momentos de la beta</h3>
<p>Si <span class="math inline">\(\mathrm{X}\)</span> es una variable aleatoria con distribución beta en los parámetros <span class="math inline">\((a,b)\)</span> el valor esperado tiene la siguiente forma</p>
<p><span class="math display">\[
E(x)=\mu=\frac{a}{a+b}
\]</span></p>
<p>Mientras que la varianza</p>
<p><span class="math display">\[
Varianza(x)=\frac{ab}{(a+b)^2(a+b+1)}
\]</span></p>
<p>Aunque desarrollandola sería</p>
<p><span class="math display">\[
Varianza(x)=\frac{ab}{(a^2+2ab+b^2)(a+b+1)}=\frac{ab}{a^3+a^2+3a^2b+3ab^2+2ab+b^3+b^2}
\]</span>
Aunque si lo quiere ver como un <em>Modelo Lineal Generalizado</em>(MLG) entonces la construcción sería</p>
<p><span class="math display">\[
Varianza(\mu)=\frac{b}{(a+b)(a+b+1)}\mu
\]</span></p>
<p>Una demostración interesante que da Gutiérrez sobre la simetría para <span class="math inline">\(f(x)\)</span> y <span class="math inline">\(f(1-x)\)</span> donde sugiere que 1-X puede ser una distribución beta si <span class="math inline">\(\mathrm{X}\)</span> se porta de la siguiente manera:</p>
<p><span class="math display">\[
X\sim Beta(a,b) \mbox{ entonces } Y=1-X \sim Beta(a,b)
\]</span></p>
<p>Demostrando la distribución de <span class="math inline">\(\mathrm{Y}\)</span> se tiene que <span class="math inline">\(y \in (0,1)\)</span>
<span class="math display">\[
F_Y(y)=Pr(Y\le y)=Pr(1-X \le y)
\]</span></p>
<p><span class="math display">\[
Pr(X\ge1-y)= \int_{1-y}^{1} \frac{x^{a-1}(1-x)^{b-1}}{B(a,b)}dx
\]</span>
Haciendo un juego <span class="math inline">\(x= 1-u\)</span></p>
<p><span class="math display">\[
F_Y(y)=\int_{0}^{y} \frac{(1-u)^{a-1}u^{b-1}}{B(a,b)}dx
\]</span>
y queda demostrado.</p>
</div>
<div id="abstracción-y-aplicación" class="section level3">
<h3>Abstracción y aplicación</h3>
<p>Un ejemplo de Robinson dice que el promedio de bateos esta dado por el número de hits(H) dividido sobre el número de turnos(AB)</p>
<p><span class="math display">\[
\mbox{Promedio de bateos}=\frac{H}{AB}
\]</span></p>
<p>Observese que el promedio esta dado en el intervalo de porcentajes de 0 a 1. El promedio tipicoes del 27%, mientras que el 30% es considerado como excepcional.</p>
<p>Suponga que desea predecir el promedio de bateo de la temporada. Si se usa el promedio de bateo al inicio de temporada se dara cuenta que es una medida muy pobre, más a través de los calculos bayesianos se podría los éxitos en bateo. Suponga que el promedio de bateo en una temporada estan dados entre 21% y 36% .</p>
<p>Se parte del supuesto que la mejor manera de representar esto (hits de bateo dado el turno del bateo) es con una distribución binomial ya que cuenta el número de éxitos de un total, por lo tanto está es la mejor manera de representar una beta.</p>
<p>Lo primero que hay que representar es su promedio de bateo, el dominio del mismo está dado entre (0,1) como una probabilidad.</p>
<p>Ya se tiene una expectativa de que el promedio de bateo en una temporada es del 27%, pero el rango razonable en el cual se da un bateo en promedio esta entre 21% y el 35%. Esto representa la distribución beta donde los parámetros estan dados de la siguiente manera:</p>
<p><span class="math display">\[
\alpha=81 \\ \beta=219
\]</span></p>
<p>Ahora se desarrolla el gráfico de densidad de la distribución ‘prior’</p>
<pre><code>## Warning: `data_frame()` is deprecated as of tibble 1.1.0.
## Please use `tibble()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<p><img src="/post/2019-02-09-Distribucion_Beta_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>La <span class="math inline">\(x\)</span> representa la distribución de posibles bateos promedios mientras que la <span class="math inline">\(y\)</span> representa la probabilidad de la densidad, la cual describe que tan probable es que el promedio de bateo caiga en un punto en particular, por lo tanto la <span class="math inline">\(y\)</span> representa la probabilidad de la densidad de la distribución beta.</p>
<p>Por lo tanto al efectuar un hit el jugador se pueden actualizar las probabilidades y comenzar con una distribución previa para después seguir con una posterior.</p>
<p><span class="math display">\[
Beta(\alpha_0+Exitos,\beta_0+Fracasos)
\]</span>
Por lo tanto si <span class="math inline">\(\alpha\)</span> se incrementa uno (un éxito más) mientras que <span class="math inline">\(\beta\)</span> no crece, entonces el promedio de la nueva distribución está dada por</p>
<p><span class="math display">\[
Beta(81+1,2019)
\]</span></p>
<p><img src="/post/2019-02-09-Distribucion_Beta_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Ahora vease la distribución de la posterior de beta junto a la posterior después de un hit o cien hits después de 300 turnos de bateo</p>
<p><img src="/post/2019-02-09-Distribucion_Beta_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Dicho lo anterior para calcular la posterior del promedio de la beta será</p>
<p><span class="math display">\[
E(x)=\mu=\frac{a}{a+b}
\]</span>
Así que después de 300 bateos , donde 100 son aciertos, mientras 200 fracasos, el nuevo valor de la distribución de la beta es</p>
<p><span class="math display">\[
E(x)=\frac{82+100}{82+100+219+200}=\frac{182}{601}=0.303
\]</span>
Teniendo presente que la inferior del estimativo está dado por</p>
<p><span class="math display">\[
\frac{100}{200+100}=0.333
\]</span></p>
<p>EL cual es más alto que el estimativo con que empezo la temporada</p>
<p><span class="math display">\[
\frac{81}{81+219}=0.27
\]</span></p>
<p>Esto da la convinación de la expectativa previa y las estimadas.</p>
</div>
<div id="conjugando-la-previa" class="section level3">
<h3>Conjugando la previa</h3>
<p>Se debe anexar una actualización de la beta a través de la binomial por lo que son matematicamente convenientes. Dicho lo anterio ver un promedio de bateos de <span class="math inline">\(\frac{100}{300}\)</span> no es preciso sobre la realidad de los jugadores, a menos que se construya una previa en se pueda encontrar dichos resultados.</p>
<p>Simularemos diez millones de jugadores, con las expectativas previas <span class="math inline">\(Beta(81,219)\)</span> y a cada uno de ellos se les dara la oportunidad de batear 300 veces</p>
<pre><code>## # A tibble: 6 x 2
##   true_average  hits
##          &lt;dbl&gt; &lt;int&gt;
## 1        0.237    85
## 2        0.251    83
## 3        0.267    77
## 4        0.252    66
## 5        0.276    91
## 6        0.239    72</code></pre>
<p>Ahora se debe buscar los jugadores que realmente cumplieron el estimativo de <span class="math inline">\(\frac{100}{300}\)</span></p>
<pre><code>## # A tibble: 6 x 2
##   true_average  hits
##          &lt;dbl&gt; &lt;int&gt;
## 1        0.325   100
## 2        0.315   100
## 3        0.297   100
## 4        0.297   100
## 5        0.289   100
## 6        0.304   100</code></pre>
<p>Ahora toca visualizar los promedios de bateo de estos <span class="math inline">\(\frac{100}{300}\)</span> e identificar que tan bueno era el jugador mediano</p>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/2019-02-09-Distribucion_Beta_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Notese que los resultados de la previa no abrian existido bateadores con la forma <span class="math inline">\(\frac{100}{300}\)</span>, por lo cual fue necesario hacer las simulaciones y encontrar los resultados.</p>
<p>Lo anterior muestra que se esta actualizando la previa</p>
<p><img src="/post/2019-02-09-Distribucion_Beta_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>La anterior gráfica de los valores verdaderos de bateo promedio, selecciona especificamente a los jugadores que han tenido records de <span class="math inline">\(60/300\)</span>, <span class="math inline">\(80/300\)</span> y <span class="math inline">\(100/300\)</span>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>En la página <a href="https://drive.google.com/file/d/0ByzoHkgSB8F3UGhmSktWaG5FWlU/view">data literacy</a> podra encontrar el libro de Gutiérrez que cuenta de manera detallada los conceptos sobres las distribuciones.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>El articulo sobre la distribución beta esta disponible <a href="http://pj.freefaculty.org/guides/stat/Distributions/DistributionWriteups/Beta/Beta.pdf">aqui</a>[^3]<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Tomado del siguiente <a href="http://pj.freefaculty.org/guides/stat/Distributions/DistributionWriteups/Beta/Beta.pdf">articulo</a><a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>Tomado del libro <a href="http://varianceexplained.org/r/empirical-bayes-book/">Empirical Bayes</a><a href="#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</div>
